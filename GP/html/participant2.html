<!DOCTYPE html>

<html>

<head>

<meta charset="UTF-8">
<title>Participant GUI</title>

<script>

	var url = "https://0h0x7juqld.execute-api.us-east-2.amazonaws.com/Alpha/weeklyschedule";
	

	function handleRetrieveSchedule() {
		let data = {};
		let form = document.codeForm;
		let startDate = form.startDate;
		let secretCode = form.secretCode;
		
		
		data["secretCode"] = secretCode.value;
		data["date"] = startDate.value;
		
		
		
		

	var js = JSON.stringify(data);
	console.log("JS:" + js);
	var xhr = new XMLHttpRequest();
	xhr.open("GET", url, true);
	
	// send the collected data as JSON
	xhr.send(js);
	
	
	xhr.onloadend = function () {
	    console.log(xhr);
	    console.log(xhr.request);
	    if (xhr.readyState == XMLHttpRequest.DONE) {
	      console.log ("XHR:" + xhr.responseText);
	      	displaySchedule(xhr.responseText);
	    } else {
	      	displaySchedule(xhr.responseText);
	    }
	};
	
	
}

	function displaySchedule(response){
		data = JSON.parse(response);

		var days = data["days"];
		console.log (days);
		
		var table = '';
		var rows = days.length;
		//var cols = 7;
		var cols = 3;
		console.log("rows"+ rows + "cols" + cols);
		
		for(var r=0; r<rows;r++){
			table += '<tr>';
			for(var c=0;c<cols;c++){
				table += '<td>' + c + '</td>';
			}
			
			table += '</tr>';
		}
			
		document.write("<h1>Weekly Schedule</h1>" + '<table border=2>' + table + '</table>');
		
	}


</script>
</head>
<h1>Weekly Schedule</h1>
<body>

<form name="codeForm" method = "post">
 <input type="text" name = "secretCode" value="Secret Code">
 <input type="date" name="startDate" min="2018-01-01">
 <input type="button" value="Go" id="goBtn" onClick="JavaScript:handleRetrieveSchedule()">
 
</form>

</body>
</html>
